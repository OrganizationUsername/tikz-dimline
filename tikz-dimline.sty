%% Dimension line for LaTeX/TikZ
%% Copyright © 2013 Sébastien Gross  <seb•ɑƬ•chezwam•ɖɵʈ•org>
%%
%% This file may be distributed and/or modified
%%
%% 1. under the LaTeX Project Public License and/or
%% 2. under the WTF Public License.
%%
%%
%% This defines Tango scheme colors for LaTeX (see
%% http://tango.freedesktop.org).
%%
%% Please note that commands have been defined using letters instead of
%% numbers (ei. "Butter 1" -> butterA)
%%
%% You can use colors:
%%
%%  - directly:                      Colored \textcolor{butterA}{text} here.
%%  - by color name:                 Colored \butterA{text} here.
%%  - by color backgroung name:      Colored \BbutterA{text} here.
%%  - by beamer overlay:             Colored \butterA<2-3>{text} here.
%%  - by beamer background overlay:  Colored \BbutterA<2-3>{text} here.
%%  - by HTML code:                  Colored \textcolor{HTML}{\butter}{text} here.
%%
%% To install it copy the tango directory to either:
%%   - $TEXHOME/tex/latex/
%%   - ~/texmf/tex/latex/
%%   - ~/Library/texmf/tex/latex
%%

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tikz-dimline}[2013/03/13 v1.0 initial version]

\RequirePackage{tikz}

\usetikzlibrary{calc}

\makeatletter


\pgfkeys{
  dimline/.is family,
  dimline,
  dimcolor/.initial = black,
  start line/.initial=1cm,
  start line width/.initial=0.01,
  end line/.initial=1cm,
  end line width/.initial=0.01,
  label pos/.initial={},
}

\newcommand\dimlineset[1]{\pgfkeys{dimline,#1}}


% #1: optional keys parameters
% #2: start point
% #3: end point
% #4: text
\newcommand{\dimline}[4][]{%

  \pgfkeys{
    dimline,
    #1,
    start line width/.get=\dimlinestartlinewidth,
    start line/.get=\dimlinestartline,
    end line/.get=\dimlineendline,
    end line width/.get=\dimlineendlinewidth,
    label pos/.get=\labelpos,
  }


  \begin{scope}[
    dimrecall/.style={\pgfkeysvalueof{/dimline/dimcolor}},
    dimline/.style={\pgfkeysvalueof{/dimline/dimcolor}},
    ]

    \node (a) at #2 {};
    \node (b) at #3 {};
    
    \draw [/tikz/dimrecall, line width=\dimlinestartlinewidth]
    (a.center) -- ($(a)!\dimlinestartline!-90:(b)$);
    \draw [dimrecall, line width=\dimlineendlinewidth]
    (b.center) -- ($(b)!\dimlineendline!90:(a)$);
  
    \draw[|<->|, dimline,] (a.center) -- (b.center)
    node[fill=white, sloped, midway] {\tiny{#4}};
  \end{scope}
}
%%\@ifclassloaded{beamer}{%
%  \renewcommand<>{\dimline}[4][]{\alt#5{\beameroriginal{\dimline}[#1]{#2}{#3}{#4}}[#1]{#2}{#3}{#4%}}
%}
\makeatother
\endinput
%% tikz-dimline.sty ends here.

